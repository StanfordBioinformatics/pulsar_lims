<%= render partial:  "application_partials/show_form_error_messages", locals: { :model_obj => @sequencing_run} %>
<header>
  <h1><%= @sequencing_run.name %></h1>  
  <ul class="actions">
    <%= render partial: "application_partials/auth_edit_record", locals: {record: @sequencing_run, nested: @sequencing_request} %>
    <%= render partial: "application_partials/auth_destroy_record", locals: {record: @sequencing_run, nested: @sequencing_request} %>
		<!-- Note that I use the SequencingRequest policy class above. The authorization will be the same level
        for both classes. I avoided using the SequencingResult class directly here since it's a nested resource
				and the partial doesn't know how to calculate the full path to the policy class in this case.
		-->
  </ul>
</header>

<%= render partial: "application_partials/record_meta", locals: { record: @sequencing_run} %>

<table class="attributes">
	<tr>
		<th><strong>Name:</strong></th>
  	<td><%= @sequencing_run.name %></td>
	</tr>

	<tr>
		<th><strong>Comment:</strong></th>
	  <td><%= @sequencing_run.comment %></td>
	</tr>

	<tr>
		<th><strong>Sequencing request:</strong></th>
  	<td><%= link_to @sequencing_request.name, @sequencing_request %></td>
	</tr>

	<tr>
	  <th><strong>Run name:</strong></th>
 	 	<td><%= @sequencing_run.run_name %></td>
	</tr>

	<tr>
		<th><strong>Lane:</strong></th>
  	<td><%= @sequencing_run.lane %></td>
	</tr>
</table>

<% if @sequencing_run.sequencing_results.present? %>
	<h4>Library Sequencing Results</h4>
	<table id="sequencing_results" class="table-bordered table-data" >
		<thead>
			<tr>
				<th>Display Name</th>
				<th>Library</th>
				<% if @sequencing_request.paired_end? %>
					<th>Paired Barcode</th>
				<% else %>
					<th>Barcode</th>
				<% end %>
				<th>Read1 Count</th>
				<th>Read1 URI</th>
				<% if @sequencing_request.paired_end? %>
					<th>Read2 Count </th>
					<th>Read2 URI</th>
				<% end %>
				<th>Comment</th>
				<th>Actions</th>
			</tr>
		</thead>
		<tbody>
				<%= render partial: "row_sequencing_result", locals: {sequencing_results: @sequencing_run.sequencing_results} %>
		</tbody>
	<% end %>
</table>
<div id="sequencing_result_form"></div>

<% if not @sequencing_run.get_libs_without_sequencing_results.any? %>
	<!-- Create hidden element for jQuery to look for. If jQuery finds it, then it will disable the link below with id="new_sequencing_result" -->
	<span id="hide_new_sequencing_result" hidden></span>
<% end %>
<%= link_to "New Barcode Result", [:new_sequencing_result,@sequencing_request,@sequencing_run], class: "reg-btn", remote: true, id: "new_sequencing_result" %>
</br></br>
