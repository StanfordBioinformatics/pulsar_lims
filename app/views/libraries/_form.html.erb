<%= simple_form_for(@library) do |f| %>
	<%= render partial:  "application_partials/show_form_error_messages", locals: { :f => f, :model_obj => @library } %>

  <%= f.input :name, label_html: {"data-toggle" => "tooltip", "title" => "Unique library name"} %>(Max. 20 characters)</br>

  <%= f.association :sequencing_library_prep_kit, label_html: {"data-toggle" => "tooltip", "title" => "The library prep kit used for creating the library."} %>

	<%= f.input :paired_end %>
  <%= f.input :strand_specific,
			label_html: {"data-toggle" => "tooltip", "title" => "Whether the preparation of the library using a strand-specific protocol."} %>

	<!-- Note that I'm using jQuery to fill the choices of the selection boxes below for barcodes and paired_barcodes. 
			 If the paired_end input is checked, then the barcodes input will be hidden. If not checked, then the
			 paired_barcodes input will be hidden. Both select inputs will be disabled until the sequencing_library_prep_kit
			 input has a value that is selected. -->
	<div id="barcode_selector">
		<% if @library.barcode.present? %>
			<%= f.association :barcode %>
		<% end %>
		<% if @library.paired_barcode.present? %>
			<%= f.association :paired_barcode %>
		<% end %>
	</div>

	<% if @library.documents.persisted.any? %>
	  <table class="min-table">
			<thead>
			  <tr><th><strong>Protocol documents:</strong></th><th></th></tr>
			</thead>
			<tbody>
			  <%= f.simple_fields_for :documents do |ff| %>
			   <% doc = @library.documents[ff.index] %>
			   <tr>
			    <td><%= doc.name %></td>
			    <td><%= ff.input_field :_destroy, as: :boolean %> Remove</td>
			   </tr>
			   <% end %>  
			</tbody>
	  </table>
	<% end %>

	<%= f.association :documents, label: "Add documents", collection: sorted_document_name_id(), prompt: "Select documents", 
			label_html: {"data-toggle" => "tooltip","title" => "Documents that provide additional information (not data file)."} %>

  <table>
  <tr><th>Sequencing Requests:</th></tr>
  <% if @library.sequencing_requests.present? %>
    <%= f.simple_fields_for :sequencing_requests do |ff| %>
      <% seqreq = @library.sequencing_requests[ff.index] %>
      <tr>
       <td><%= seqreq.name %></td>
       <td><%= ff.input_field :_destroy, as: :boolean %> Remove</td>
      </tr>
      <% end %>  
  <% end %>
  </table></br>

  <%= f.association :nucleic_acid_term, label: "Nucleic Acid Term Name", collection: NucleicAcidTerm.order(:name), 
			label_method: :name, prompt: "Select the Term Name",
			label_html: {"data-toggle" => "tooltip","title" => "SO (Sequence Ontology) term best matching the molecule isolated to generate the library (e.g. 'RNA' for a total RNA library, even if that library is subsequently reverse transcribed for DNA sequencing.)"} %>

  <%= f.association :biosample, collection: Biosample.order(:name), label_method: :name, prompt: "Select the Biosample",
			label_html: {"data-toggle" => "tooltip","title" => "The biosample that nucleic acid was isolated from to generate the library."} %>

  <%= f.association :vendor, collection: Vendor.order(:name), label_method: :name,  prompt: "Select the Vendor",
			label_html: {"data-toggle" => "tooltip", "title" => "The vendor, for nucleic acids or proteins purchased directly from a vendor (e.g. total RNA)."} %>

	<%= f.association :library_fragmentation_method,
			label_html: {"data-toggle" => "tooltip", "title" => "A short description or reference of the nucleic acid fragmentation protocol used in library preparation, if applicable."} %>

  <%= f.input :lot_identifier, 
			label_html: {"data-toggle" => "tooltip", "title" => "The lot identifier provided by the vendor, for nucleic acids or proteins purchased directly from a vendor (e.g. total RNA)."} %>

  <%= f.input :vendor_product_identifier,
			label_html: {"data-toggle" => "tooltip", "title" => "The product identifier provided by the vendor, for nucleic acids or proteins purchased directly from a vendor (e.g. total RNA)."} %>

	<label for="library_nucleic_acid_starting_quantity" data-toggle="tooltip" title="The starting amount of nucleic acid before selection and purification."><span>Nucleic acid starting quantity </span></label>
	<%= f.input_field :nucleic_acid_starting_quantity %>
	<label for="library_nucleic_acid_starting_quantity_units" data-toggle="tooltip" title="The units used for starting amount of nucleic acid."><span>Units </span></label>
	<%= f.input_field :nucleic_acid_starting_quantity_units, collection: Library::NUCLEIC_ACID_STARTING_QUANTITY_UNITS  %>
	</br></br>

  <%= f.input :size_range, as: :string,
			label_html: {"data-toggle" => "tooltip", "title" => "The measured size range of the purified nucleic acid, in bp."} %>

  <div class="actions">
    <%= f.button :submit, class: "btn-primary "%>
  </div></br>
<% end %>
