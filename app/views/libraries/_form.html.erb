<%= form_for(@library) do |f| %>
  <% if @library.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@library.errors.count, "error") %> prohibited this library from being saved:</h2>

      <ul>
      <% @library.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    Library Name:</br>
    <%= f.text_field :name %>(Max. 20 characters)
  </div></br>

  <div>
    Associated Protocol Documents:
    <% if @library.new_record? %>
      None
    <% else %>
      <%= render(@library.documents) %>
    <% end %>
  </div></br>

  <div>
    <!-- Show select for Documents. Mutliple documents can be selected.
         If the form was rejected due to a validation error, then the
         user will have been presented with this form again to correct it, 
         and I set the default selectioned to what the user had originally, 
         if any. -->
    <% selected = nil %>
    <% if @library.documents and @library.new_record? %>
      <% selected = @library.documents.map{|x| x.id} %>
    <% end %>
    <%= render(partial: "documents/add_document", locals: {f: f,selected: selected}) %>
  </div></br>

  <div class="field">
		Nucleic Acid Term Name:</br>
		<% sequence_ontology_term_id = nil %>
		<% if not @library.sequence_ontology_term.nil? %>
			<% sequence_ontology_term_id = @library.sequence_ontology_term.id %>
		<% end %>
    <%= f.select :sequence_ontology_term_id,choices=options_for_select(sorted_so_name_id,selected=sequence_ontology_term_id),html_options={:prompt => "Select the Term Name"} %>
  </div>

  <div class="field">
    <%= f.label :biosample %><br>
		<% biosample_id = nil %>
		<% if not @library.biosample.nil? %>
			<% biosample_id = @library.biosample.id %>
		<% end %>
    <%= f.select :biosample_id,choices=options_for_select(sorted_biosample_name_id,selected=biosample_id),html_options={:prompt => "Select the Biosample"} %>
  </div>

  <div class="field">
    <%= f.label :antibody %><br>
		<% antibody_id = nil %>
		<% if not @library.antibody.nil? %>
			<% antibody_id = @library.antibody.id %>
		<% end %>
    <%= f.select :antibody_id,choices=options_for_select(sorted_antibody_name_id,selected=antibody_id),html_options={:prompt => "Select the Antibody"} %>
  </div>

  <div class="field">
    <%= f.label :vendor_id %>
    <% vendor_id = nil %>
    <% if not @library.vendor.nil? %>
      <% vendor_id = @library.vendor.id %>
    <% end %>
    <%= f.select :vendor_id, choices=options_for_select(sorted_vendor_name_id,selected=vendor_id),html_options={:prompt => "Select the Vendor"} %>
  </div>

  <div class="field">
    <%= f.label :lot_identifier %><br>
    <%= f.text_field :lot_identifier %>
  </div>

  <div class="field">
    <%= f.label :vendor_product_identifier %><br>
    <%= f.text_field :vendor_product_identifier %>
  </div>

  <div class="field">
    <%= f.label :size_range %><br>
    <%= f.text_field :size_range %>(i.e. 450-650)
  </div>

  <div class="field">
		Strand Specific: <%= f.check_box :strand_specificity %>
  </div>

  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
